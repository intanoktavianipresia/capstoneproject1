<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Portal Akademik</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Anton&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/login.css" />
  </head>
  <body>
    <div class="main-content">
      <div class="login-container">
        <!-- HEADER -->
        <div class="header">
          <img src="assets/img/logo.svg" alt="Logo" class="logo" />
          <div class="header-title">PORTAL AKADEMIK</div>
        </div>

        <!-- BACKGROUND IMAGE -->
        <img
          src="assets/img/gedung-unib.jpeg"
          alt="Gedung Kampus"
          class="building-image"
        />

        <!-- ALERT CONTAINER -->
        <div id="alertContainer" style="display: none"></div>

        <!-- LOGIN FORM -->
        <div class="form-container">
          <form id="loginForm">
            <!-- Username -->
            <div class="input-group-custom">
              <input
                type="text"
                class="form-control-custom"
                id="nimInput"
                name="nim"
                placeholder="Username"
                required
                autocomplete="username"
              />
              <i class="bi bi-person-circle input-icon"></i>
            </div>

            <!-- Password -->
            <div class="input-group-custom">
              <input
                type="password"
                class="form-control-custom"
                id="passwordInput"
                name="password"
                placeholder="Password"
                required
                autocomplete="current-password"
              />
              <i
                class="bi bi-eye-slash input-icon toggle-password"
                id="togglePassword"
              ></i>
            </div>

            <!-- Error Message -->
            <div
              id="errorMessage"
              class="error-message"
              style="display: none"
            ></div>

            <!-- LOGIN BUTTON -->
            <button type="submit" class="btn-login" id="loginButton">
              <span id="loginText">Login</span>
              <span
                id="loginSpinner"
                class="spinner-border spinner-border-sm"
                style="display: none"
              ></span>
            </button>
          </form>
        </div>
      </div>
    </div>

    <div class="footer">© 2025 Sistem Portal Login Deteksi Anomali</div>

    <!-- ✅ MODAL 1: PERINGATAN AKTIVITAS (Risk Sedang - Masih Bisa Login) -->
    <div
      class="modal fade"
      id="warningActivityModal"
      tabindex="-1"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body text-center py-5">
            <i
              class="bi bi-exclamation-triangle-fill"
              style="font-size: 4rem; color: #ffc107"
            ></i>
            <h5 class="mt-3 fw-bold">Peringatan Aktivitas Mencurigakan</h5>
            <p class="text-muted" id="delayedMessage">
              Terdeteksi aktivitas login yang tidak biasa (IP/perangkat
              baru).<br />
              Login tetap diizinkan, namun akun Anda akan dipantau.
            </p>
            <p class="text-muted">
              <small
                >Silakan ganti password Anda segera untuk keamanan akun.</small
              >
            </p>
            <button
              type="button"
              class="btn btn-warning px-4"
              id="proceedWarningButton"
            >
              <i class="bi bi-check-circle"></i> Lanjut Login
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ✅ MODAL 2: LOGIN DITUNDA (Risk Tinggi - Countdown) -->
    <div
      class="modal fade"
      id="delayedModal"
      tabindex="-1"
      aria-hidden="true"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body text-center py-5">
            <i
              class="bi bi-hourglass-split"
              style="font-size: 4rem; color: #ff6b35"
            ></i>
            <h5 class="mt-3 fw-bold">Login Ditunda</h5>
            <p class="text-muted" id="delayedMessage">
              Aktivitas mencurigakan terdeteksi.<br />
              Login Anda ditunda sementara untuk verifikasi keamanan.
            </p>

            <!-- ✅ COUNTDOWN TIMER -->
            <div class="my-4">
              <div
                id="delayedCountdown"
                style="
                  font-size: 3rem;
                  font-weight: bold;
                  color: #ff6b35;
                  font-family: 'Courier New', monospace;
                "
              >
                1:00
              </div>
              <small class="text-muted"
                >Mohon tunggu hingga waktu selesai</small
              >
            </div>

            <div class="alert alert-warning d-inline-block" role="alert">
              <small>
                <i class="bi bi-info-circle-fill"></i>
                Akun Anda masuk dalam sistem pantauan admin
              </small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ✅ MODAL 3: AKUN DITUNDA (Brute Force - dari login sebelumnya) -->
    <div
      class="modal fade"
      id="suspendedModal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body text-center py-5">
            <i
              class="bi bi-hourglass-split"
              style="font-size: 4rem; color: #6c757d"
            ></i>
            <h5 class="mt-3 fw-bold">Akun Anda Ditunda Sementara</h5>
            <p class="text-muted" id="suspendedMessage">
              karena terlalu banyak percobaan gagal.<br />
              Silakan coba lagi dalam <span id="suspendedTime">5 menit</span>.
            </p>
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Tutup
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ✅ MODAL 4: AKUN DIBLOKIR (Risk Kritis) -->
    <div class="modal fade" id="blockedModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body text-center py-5">
            <i
              class="bi bi-lock-fill"
              style="font-size: 4rem; color: #dc3545"
            ></i>
            <h5 class="mt-3 fw-bold">Akun Anda Diblokir</h5>
            <p class="text-muted">
              Akun Anda diblokir karena terdeteksi aktivitas sangat
              mencurigakan.<br />
              Silakan hubungi <strong>Admin LPTIK</strong> untuk membuka blokir
              dan verifikasi akun.
            </p>
            <div class="alert alert-danger d-inline-block" role="alert">
              <small>
                <i class="bi bi-shield-fill-exclamation"></i>
                Password Anda mungkin telah direset oleh admin
              </small>
            </div>
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Tutup
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="assets/js/utils.js"></script>
    <script src="assets/js/config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="assets/js/login.js"></script>
  </body>
</html>
